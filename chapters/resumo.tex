% !TEX root = ../PhD Thesis.tex
\chapter*{Resumo}
\addcontentsline{toc}{chapter}{Resumo}
% 1200 a 1500 palavras

Durante o meu doutoramento no Instituto de Medicina Molecular João Lobo Antunes (iMM), desenvolvi aplicações \emph{web} na área da transcritómica como recursos gratuitos e de código aberto disponíveis à comunidade científica, que tenho melhorado e mantido frequentemente. Estas aplicações foram construídas a partir da linguagem de programação R com elementos gráficos baseados em \emph{Shiny}, um pacote de R para criar aplicações \emph{web}, e estão alojados no Bioconductor, um repositório de pacotes de R para análise de dados biológicos.

\section*{psichomics}

O \emph{splicing} alternativo é um mecanismo molecular que permite gerar vários transcritos funcionais a partir do mesmo gene e está envolvido no controlo de múltiplos processos celulares, sendo a sua desregulação associada a várias patologias. A sua relevância biológica e os avanços na tecnologia de sequenciação de RNA têm levado a um maior interesse no seu estudo e na publicação de dados de \emph{splicing} alternativo \cite{wang:2008wa,tsai:2015ve,danan-gotthold:2015ut,chhibber:2017wm,climente-gonzalez:2017uj}. Este tipo de dados tem sido disponibilizado em acesso livre por vários projectos científicos, incluindo o The Cancer Genome Atlas (TCGA), que cataloga dados clínicos e moleculares de múltiplos tumores humanos \cite{chang:2013ww}; o Genotype-Tissue Expression (GTEx), que se foca em dados de múltiplos tecidos humanos normais \cite{lonsdale:2013uo}; e o recount2, que processou dados de mais de 2000 estudos oriundos do Sequence Read Archive (SRA) \cite{collado-torres:2017uw}.

A utilização dos dados pré-processados provenientes destes projectos evita o armazenamento e processamento dos ficheiros com dados de sequenciação \emph{em bruto}, facilitando a análise de expressão génica e \emph{splicing} alternativo ao poupar tempo e recursos computacionais dispendiosos no processamento de dados. Também é importante notar que dados humanos não processados podem ter acesso limitado e requerer um pedido de autorização para acesso total por razões de privacidade dos dadores. No entanto, até 2018, nenhuma ferramenta permitia realizar uma análise diferencial de \emph{splicing} alternativo com base em dados transcritómicos pré-processados descarregados destas fontes públicas e com agrupamento das amostras a partir dos seus metadados.

Assim, desenvolvi a ferramenta psichomics para quantificar, analisar e visualizar \emph{splicing} alternativo, inicialmente a partir de dados pré-processados provenientes do TCGA \cite{chang:2013ww}. Através da sua interface gráfica intuitiva ou da linha de comandos em R, o psichomics permite ao utilizador realizar análises de \emph{splicing} e expressão diferencial, de componentes principais, e de sobrevivência com incorporação de características moleculares e clínicas das amostras consideradas.

Durante o meu doutoramento, a versão original do psichomics foi melhorada de forma a descarregar e processar dados de fontes adicionais -- incluindo do GTEx \cite{lonsdale:2013uo}, do recount2 \cite{collado-torres:2017uw} e provenientes do utilizador --, analisar expressão génica e quantificar \emph{splicing} alternativo para 14 espécies diferentes, entre outras novidades.

% O psichomics está preparado para carregar dados de junções de \emph{splicing} provenientes do utilizador ou de fontes externas, seguido da quantificação de \emph{splicing} alternativo (caso a quantificação em si não seja carregada). Esta quantificação é calculada com base nas \emph{reads} de RNA-seq que alinham contra junções exão-exão e nas coordenadas genómicas (anotação) dos eventos de \emph{splicing} alternativo. A proporção de \emph{reads} alinhadas às junções que suportam a isoforma de inclusão, denominada por \emph{Percent Spliced-In} ou PSI \cite{wang:2008wa}, foi a métrica de quantificação escolhida.

Após a publicação do artigo relativo ao psichomics em 2018 \cite{saraiva-agostinho:2018uq}, fomos convidados a escrever um capítulo de métodos no livro \emph{Stem Cell Transcriptional Networks}, publicado em 2020, no qual exemplificamos a utilização do psichomics para analisar \emph{splicing} alternativo no contexto de células estaminais humanas \cite{saraiva-agostinho:2020wz}. Desde a sua publicação, o psichomics foi usado em projectos associados a vários artigos científicos \cite{coomer:2019wz,baeza-centurion:2019tb,munkley:2019wr,baeza-centurion:2020vb}. Acreditamos que estas citações, juntamente com os comentários positivos que temos vindo a receber dos utilizadores, demonstram que vários investigadores conseguiram usufruir do psichomics para os auxiliar na descoberta de factores de prognóstico e alvos terapêuticos associados a \emph{splicing}, assim como no avanço do nosso conhecimento sobre como o \emph{splicing} alternativo é regulado em contextos fisiológico e de doença.

\section*{cTRAP}

O Connectivity Map (CMap) é um repositório público de assinaturas transcritómicas de centenas de perturbações genéticas e farmacológicas de linhas celulares de cancro humanas \cite{subramanian:2017ul}. Ao comparar alterações de expressão génica com os do CMap, podemos inferir potenciais causas moleculares para as diferenças observadas e compostos que possam promover ou reverter essas alterações.

O CMap and LINCS Unified Environment (\alink{clue.io}) foi desenvolvido como um conjunto de ferramentas intuitivas para explorar os dados do CMap e integrá-los com dados disponibilizados pelo utilizador \cite{subramanian:2017ul}. No entanto, o \alink{clue.io} limita o número máximo de genes considerados para comparar com o CMap, expressa os resultados através de um valor de significância não convencional (e, portanto, de interpretação não imediata), é difícil de automatizar para análises subsequentes e não permite utilizar recursos computacionais locais. Além disso, o \alink{clue.io} não permite actualmente integrar dados de sensibilidade aos compostos, que podem auxiliar na identificação de compostos que afectem apenas células específicas e que tenham genes específicos como alvos moleculares.

Para colmatar estas lacunas, desenvolvemos o cTRAP para identificar perturbações moleculares causais potenciais ao comparar resultados de expressão génica diferencial providenciados pelo utilizador com os do CMap, assim como prever compostos que promovam ou revertam as diferenças observadas. O cTRAP também permite comparar aqueles resultados com associações entre expressão génica e sensibilidade aos compostos derivados do NCI-60 \cite{shoemaker:2006wi}, do Cancer Therapeutics Response Portal (CTRP) \cite{seashore-ludlow:2015ws} e do Genomics of Drug Sensitivity in Cancer (GDSC) \cite{yang:2012vk}, para identificar compostos que podem alvejar os fenótipos associados com os perfis de expressão diferencial do utilizador. Inclui também uma análise similar à do Gene-Set Enrichment Analysis (GSEA) \cite{subramanian:2005wu} para identificar o enriquecimento de descritores moleculares nos compostos do NCI-60 e do CMap de interesse. No cTRAP, a similaridade entre resultados de expressão diferencial do utilizador e do CMap baseia-se no enriquecimento dos genes mais e menos expressos do fenótipo observado \cite{subramanian:2017ul,subramanian:2005wu} e nos valores de correlação entre estatísticas de expressão diferencial.

O manuscrito associado ao cTRAP (do qual eu sou co-primeiro autor e autor co-correspondente) encontra-se em preparação para submissão a uma revista científica \emph{peer-reviewed} internacional. Esperamos que o cTRAP permita aos seus utilizadores identificar perturbações moleculares responsáveis pelos fenótipos em estudo para melhor compreensão dos mecanismos biológicos associados, tal como prever agentes terapêuticos relevantes.

\section*{CompBio: servidor de aplicações \emph{web}}

As interfaces gráficas do psichomics e cTRAP auxiliam os utilizadores a explorar a maioria das funções dos respectivos programas de forma interactiva através de passos simples, demonstrados em tutoriais online, que são, tal como as próprias ferramentas, actualizados frequentemente mediante o parecer dos utilizadores.

No entanto, os tradicionais canais de distribuição de pacotes de R, que usamos para distribuir o psichomics e o cTRAP (como o CRAN e o Bioconductor), podem ser dissuasores para quem não se sentir confortável a usar a linha de comandos do R. Assim, procurei formas alternativas de disponibilizar as nossas aplicações, até encontrar o ShinyProxy, um programa de código aberto para hospedar aplicações R/Shiny e Python como aplicações \emph{web} através de instâncias (\emph{containers}) de Docker.

Com o ShinyProxy, é necessário um servidor para correr as suas aplicações em tempo real. Dessa forma, para disponibilizar as ferramentas de forma gratuita e acessível, dependendo apenas de navegadores de \emph{Internet} modernos, criámos o servidor CompBio para alojar o psichomics, o cTRAP e diversos outros pacotes de R como aplicações \emph{web} -- incluindo programas construídos pelos meus colegas de laboratório (voyAGEr, betAS e scStudio). O projecto CompBio está actualmente a correr numa máquina virtual Linux no \emph{cluster} de computação do iMM.

O coração deste projecto é o Docker Compose, um programa que permite gerir múltiplos serviços em simultâneo que correm a partir de imagens Docker e que interagem entre si, incluindo o ShinyProxy, um \emph{proxy} reverso para gerir os pedidos dos utilizadores (Nginx) e programas para correr processos em segundo plano (Celery, Redis e Flower), analisar o tráfego dos visitantes do \emph{website} (Plausible, PostgreSQL e ClickHouse), monitorar recursos computacionais em utilização (Prometheus e Grafana) e facilitar o desenvolvimento (RStudio Web para testar e desenvolver soluções directamente no servidor).

Todo o código deste projecto está publicamente disponível em \alink{github.com/nuno-agostinho/compbio-app-server}, é de fácil configuração e pode ser facilmente migrado para qualquer máquina, dependo apenas da instalação da plataforma Docker. Para adicionar novas aplicações ao projecto, basta editar as definições do ShinyProxy num ficheiro de texto e disponibilizar a respectiva imagem Docker localmente no servidor ou no repositório Docker Hub. A manutenção do projecto também é fácil, dado que basta actualizar a versão das imagens Docker usadas no projecto e reiniciar esses serviços com o Docker Compose.

Quero aproveitar este momento para sugerir uma pausa para sentar e relaxar, para deambular pelo nosso \emph{website} em \alink{compbio.imm.medicina.ulisboa.pt}, para acordar as aplicações \emph{web} que ali pernoitam e para desfrutar da viagem. A página principal é uma galeria de trabalho do nosso laboratório, trabalho que tenho um tremendo orgulho em apoiar.\\

\textbf{Palavras-chave:} bioinformática, aplicações \emph{web}, \emph{splicing} alternativo, expressão génica, perturbações genéticas e farmacológicas.

